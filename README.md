# ğŸ“˜ Project OSHI-ME (ä»®) ãƒã‚¹ã‚¿ãƒ¼é–‹ç™ºä»•æ§˜æ›¸ v1.0

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
**Vision**: æ¨ã—æ´»ãƒ»ã‚¨ãƒ³ã‚¿ãƒ¡é ˜åŸŸã«ãŠã‘ã‚‹ã€Œä¿¡é ¼ã§ãã‚‹Wikiã€Ã—ã€Œç†±é‡ã®ã‚ã‚‹ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ã‚’çµ±åˆã—ãŸUGMï¼ˆUser Generated Mediaï¼‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€‚
**Core Value**: 
1. ãƒ•ã‚¡ãƒ³ãŒä½œã‚Šä¸Šã’ã‚‹æ­£ç¢ºã§è©³ç´°ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆWikiï¼‰ã€‚
2. 1æ—¥1å›ã®æŠ•ç¥¨ã«ã‚ˆã‚‹ã€ä¿¡é ¼æ€§ã®é«˜ã„ã€Œæ¨ã—ã€è©•ä¾¡ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã€‚

---

## 2. ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ & æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ç–çµåˆã«ã™ã‚‹ **Headlessæ§‹æˆ** ã‚’æ¡ç”¨ã€‚

### ğŸ›  Tech Stack
| é ˜åŸŸ | æŠ€è¡“é¸å®š | è£œè¶³ |
| :--- | :--- | :--- |
| **Frontend** | **Next.js (React / TypeScript)** | SSR/SPAãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ã€‚Vercelç­‰ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’æƒ³å®šã€‚ |
| **Backend** | **Ruby on Rails (API Mode)** | JSONã‚’è¿”å´ã™ã‚‹RESTful APIã‚µãƒ¼ãƒãƒ¼ã€‚ |
| **Database** | **MySQL (Amazon RDS)** | ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã€‚ |
| **Infra** | **AWS (EC2/ECS + S3)** | ç”»åƒã¯S3ã€APIã¯EC2/ECSã¸ã€‚ |
| **Auth** | **Rails + JWT** (äºˆå®š) | èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”¨ã„ãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã€‚ |
| **Design** | **Figma** | ç”»é¢è¨­è¨ˆãƒ»ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã®ä½œæˆã€‚ |

---

## 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ (Schema Definition)

### 3-1. Users (ã‚µãƒãƒ¼ã‚¿ãƒ¼)
ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã¨ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ã€‚
- **id**: integer (PK)
- **nickname**: string (è¡¨ç¤ºå / å¿…é ˆ)
- **x_username**: string (X ID / ä»»æ„)
- **email**: string (ãƒ­ã‚°ã‚¤ãƒ³ç”¨ / unique)
- **password_digest**: string (ãƒãƒƒã‚·ãƒ¥åŒ–ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰)
- **created_at**: datetime

### 3-2. Core Content (Wikiæœ¬ä½“)
#### Artists (ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ)
- **id**: integer (PK)
- **name**: string (åå‰ / å¿…é ˆ)
- **bio**: text (çµŒæ­´ãƒ»ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰)
- **mbti**: string (ä¾‹: ENFP / ä»»æ„)
- **member_color**: string (ãƒ¡ãƒ³ãƒãƒ¼ã‚«ãƒ©ãƒ¼ / ä»»æ„)
- **birth_date**: date (ç”Ÿå¹´æœˆæ—¥ / ä»»æ„)
- **birthplace**: string (å‡ºèº«åœ° / ä»»æ„)
- **created_at**: datetime

#### Groups (ã‚°ãƒ«ãƒ¼ãƒ—)
- **id**: integer (PK)
- **name**: string (ã‚°ãƒ«ãƒ¼ãƒ—å / å¿…é ˆ)
- **created_at**: datetime

#### Memberships (æ‰€å± / ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«)
- **id**: integer (PK)
- **artist_id**: integer (FK)
- **group_id**: integer (FK)
- **joined_at**: date (åŠ å…¥æ—¥)
- **left_at**: date (è„±é€€æ—¥ / NULL=ç¾å½¹)
- **role**: string (å½¹å‰²: ãƒªãƒ¼ãƒ€ãƒ¼ã€ã‚»ãƒ³ã‚¿ãƒ¼ãªã©)

### 3-3. Engagement (æ¨ã—æ´»ãƒ»è©•ä¾¡)
#### Reviews (æŠ•ç¥¨ãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼)
**åˆ¶ç´„**: åŒä¸€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»åŒä¸€ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã¸ã®æŠ•ç¨¿ã¯ã€Œ1æ—¥1å›ã€ã¾ã§ã€‚
- **id**: integer (PK)
- **user_id**: integer (FK)
- **artist_id**: integer (FK)
- **rating**: integer (1ã€œ7ã®7æ®µéšè©•ä¾¡ / å¿…é ˆ)
- **comment**: text (æ„Ÿæƒ³ / ä»»æ„)
- **created_at**: datetime

#### Favorites (æ¨ã—è¨­å®š)
**åˆ¶ç´„**: `is_primary: true` ã¯1ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¤ã1ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã¿ã€‚
- **id**: integer (PK)
- **user_id**: integer (FK)
- **artist_id**: integer (FK)
- **is_primary**: boolean (ç¥æ¨ã—ãƒ•ãƒ©ã‚°)
- **since**: date (æ¨ã—å§‹ã‚ãŸæ—¥)

### 3-4. Wiki Moderation (ç·¨é›†ãƒ»æ‰¿èª)
æƒ…å ±ã®è³ªã‚’æ‹…ä¿ã™ã‚‹æ‰¿èªãƒ•ãƒ­ãƒ¼ç”¨ã€‚
#### Artist_Revisions (ç·¨é›†å±¥æ­´)
- **id**: integer (PK)
- **artist_id**: integer (FK)
- **user_id**: integer (FK / ç·¨é›†è€…)
- **content**: json/text (å¤‰æ›´å¾Œã®ãƒ‡ãƒ¼ã‚¿ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰)
- **status**: string ('pending', 'approved', 'rejected')
- **ai_score**: float (AIã«ã‚ˆã‚‹å®‰å…¨æ€§ã‚¹ã‚³ã‚¢)
- **ai_check_log**: text (AIã®åˆ¤å®šã‚³ãƒ¡ãƒ³ãƒˆ)
- **moderator_id**: integer (æ‰¿èªè€…ID)
- **created_at**: datetime

---

## 4. APIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¦ç´„ (FE â‡” BE Contract)

### 4-1. é€šä¿¡ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
* **Request**: JSON (`snake_case` æ¨å¥¨)
* **Response**: JSON (`snake_case` ã§è¿”å´ã—ã€FEå´ã§CamelCaseã¸å¤‰æ›ã—ã¦æ‰±ã†ã“ã¨ã‚’æ¨å¥¨)

### 4-2. ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¨­è¨ˆæ¨™æº–
**æˆåŠŸæ™‚ (200 OK)**
```json
{
  "data": {
    "id": 1,
    "name": "Artist Name",
    "attributes": { ... }
  }
}

```

**ã‚¨ãƒ©ãƒ¼æ™‚ (4xx, 5xx)**

```json
{
  "error": {
    "code": "ALREADY_VOTED_TODAY",
    "message": "æœ¬æ—¥ã®æŠ•ç¥¨ã¯å®Œäº†ã—ã¦ã„ã¾ã™ã€‚",
    "details": "Next vote available at 2026-02-12 00:00:00"
  }
}

```

---

## 5. ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ä»•æ§˜

### 5-1. ãƒ¬ãƒ“ãƒ¥ãƒ¼æŠ•ç¨¿ï¼ˆæŠ•ç¥¨ï¼‰åˆ¶é™

* **ä»•æ§˜**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯åŒä¸€ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã«å¯¾ã—ã¦ã€**1æ—¥ï¼ˆ0:00ã€œ23:59 JSTï¼‰ã«1å›ã®ã¿**æŠ•ç¥¨å¯èƒ½ã€‚
* **BEå®Ÿè£…**: `Reviews` ä½œæˆæ™‚ã€`created_at` ãŒ `Date.today` ã®ç¯„å›²ã«ã‚ã‚‹æ—¢å­˜ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€‚å­˜åœ¨ã™ã‚‹å ´åˆã¯ `422 Unprocessable Entity` ã‚’è¿”ã™ã€‚

### 5-2. Wikiç·¨é›†æ‰¿èªãƒ•ãƒ­ãƒ¼

1. **FE**: ç·¨é›†å†…å®¹ã‚’ POST `/api/artists/:id/revisions` ã¸é€ä¿¡ã€‚
2. **BE**: `artist_revisions` ã« `status: 'pending'` ã§ä¿å­˜ã€‚
3. **Admin/Mod**: ç®¡ç†ç”»é¢ç­‰ã§å†…å®¹ã‚’ç¢ºèªã—æ‰¿èªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã€‚
4. **BE**: `status` ã‚’ `approved` ã«æ›´æ–°ã—ã€`artists` ãƒ†ãƒ¼ãƒ–ãƒ«ã®æœ¬ãƒ‡ãƒ¼ã‚¿ã‚’ä¸Šæ›¸ãæ›´æ–°ï¼ˆUpdateï¼‰ã€‚
* å°†æ¥çš„ã«ã¯AIãƒã‚§ãƒƒã‚¯ã‚’æŒŸã‚€ã€‚



### 5-3. ç¥æ¨ã— (Kami-oshi) è¨­å®š

* **ä»•æ§˜**: ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã§ã€Œç¥æ¨ã— (is_primary)ã€ã«è¨­å®šã§ãã‚‹ã®ã¯1äººã®ã¿ã€‚
* **BEå®Ÿè£…**: `favorites` ä½œæˆ/æ›´æ–°æ™‚ã« `is_primary: true` ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã•ã‚ŒãŸå ´åˆã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å†…ã§ã€Œã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ—¢å­˜ã® `is_primary` ã‚’ã™ã¹ã¦ `false` ã«ãƒªã‚»ãƒƒãƒˆã€ã—ã¦ã‹ã‚‰ã€å¯¾è±¡ã‚’ `true` ã«è¨­å®šã™ã‚‹ã€‚

---

## 6. é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ & ãƒ«ãƒ¼ãƒ«

### 6-1. Git / GitHub Flow

åŸºæœ¬æ–¹é‡: `main` ãƒ–ãƒ©ãƒ³ãƒã¯å¸¸ã«ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½ãªçŠ¶æ…‹ã‚’ä¿ã¤ã€‚

1. **Issues**: GitHub Issues ã§ã‚¿ã‚¹ã‚¯ã‚’èµ·ç¥¨ã€‚ã€ŒFEã€ã€ŒBEã€ã€ŒDesignã€ãƒ©ãƒ™ãƒ«ã‚’ä½¿ç”¨ã€‚
2. **Branch**: `feature/issuesç•ªå·-æ©Ÿèƒ½å` (ä¾‹: `feature/12-add-review-api`)
3. **Pull Request (PR)**:
* ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã€Œå¤‰æ›´å†…å®¹ã€ã€Œå‹•ä½œç¢ºèªæ–¹æ³•ã€ã‚’è¨˜è¼‰ã€‚
* **ç›¸äº’ãƒ¬ãƒ“ãƒ¥ãƒ¼**: BEã®ã‚³ãƒ¼ãƒ‰ã¯FEæ‹…å½“ãŒã€FEã®ã‚³ãƒ¼ãƒ‰ã¯BEæ‹…å½“ãŒç¢ºèªã—ã€ä»•æ§˜èªè­˜ã®ã‚ºãƒ¬ã‚’é˜²ãã€‚



### 6-2. ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³

* **GitHub Comments**: ã‚³ãƒ¼ãƒ‰å˜ä½ã®è­°è«–ã¯PRä¸Šã§è¡Œã†ã€‚
* **GitHub Projects**: ã‚«ãƒ³ãƒãƒ³å½¢å¼ã§é€²æ—ç®¡ç†ã€‚ã€ŒTodoã€ã€ŒIn Progressã€ã€ŒReviewã€ã€ŒDoneã€ã€‚

### 6-3. ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼

1. **Figma**: ç”»é¢UIã‚’ä½œæˆã€‚
2. **Review**: ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢2åã§ã™ã‚Šåˆã‚ã›ï¼ˆå®Ÿè£…å¯èƒ½æ€§ã®ç¢ºèªï¼‰ã€‚
3. **Code**: åˆæ„å¾Œã«ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°é–‹å§‹ã€‚

---

## 7. Next Actions (Week 1)

1. **Repo**: GitHubãƒªãƒã‚¸ãƒˆãƒªä½œæˆã€‚
2. **Design**: Figmaã§ã€Œã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆè©³ç´°ã€ã€Œãƒ¬ãƒ“ãƒ¥ãƒ¼æŠ•ç¨¿ã€ã®UIä½œæˆã€‚
3. **BE**: Railsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã€Migrationå®Ÿè¡Œã€‚
4. **FE**: Next.jsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã€å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŸºç›¤ä½œæˆã€‚
